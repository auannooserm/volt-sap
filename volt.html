<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@400;600&display=swap');
  body { font-family: 'Kanit', sans-serif; background: linear-gradient(135deg, #74ebd5, #ACB6E5); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 15px;}
  .container { background: #fff; padding: 30px 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.08); width: 100%; max-width: 420px; text-align: center; }
  h2 { color: #333; font-size: 1.5em; margin-bottom: 15px; }
  button { width: 100%; padding: 14px 0; margin: 10px 0; border: none; border-radius: 10px; font-size: 1rem; cursor: pointer; transition: all 0.3s ease; font-weight: 600; }
  button:hover { transform: scale(1.03); opacity: 0.95; }
  .team-btn { background: #7097c5; color: #fff; }
  .solo-btn { background: #F4A261; color: #fff; }
  .admin-btn { background: #6C63FF; color: #fff; }
  .option-team { background: #7d92c7; color: #fff; }
  .option-solo { background: #A6C3E4; color: #fff; }
  .bar { height: 28px; border-radius: 8px; margin: 10px 0; color: white; line-height: 28px; padding-left: 10px; font-weight: 600; transition: width 0.5s ease; font-size: 0.9rem; }
  .bar-container { background: #e9ecef; border-radius: 8px; overflow: hidden; }
  #votePageTeam,#votePageSolo,#thankYou,#resultsPage,#adminPanel,#adminResults { display:none; }
  @media (max-width:480px){ .container{padding:25px 20px;} h2{font-size:1.3em;} }
</style>
</head>
<body>

<div id="homePage" class="container">
  <h2>‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢ ü•∞</h2>
  <button class="team-btn" onclick="showTeam()">‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡∏°</button>
  <button class="solo-btn" onclick="showSolo()">‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</button>
  <button class="admin-btn" onclick="promptAdmin()">Admin</button>
</div>

<div id="votePageTeam" class="container">
  <h2>‡πÇ‡∏´‡∏ß‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡∏°</h2>
  <button class="option-team" onclick="vote('‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏ô‡∏≠‡∏±‡∏ß')">‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏ô‡∏≠‡∏±‡∏ß</button>
  <button class="option-team" onclick="vote('‡∏ó‡∏µ‡∏°‡∏™‡∏ß‡∏¢‡πÉ‡∏´‡πâ 5 ‡∏°‡∏±‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ 10')">‡∏ó‡∏µ‡∏°‡∏™‡∏ß‡∏¢‡πÉ‡∏´‡πâ 5 ‡∏°‡∏±‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ 10</button>
  <button class="option-team" onclick="vote('‡∏ó‡∏µ‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏†‡∏≤‡∏û‡∏Å‡∏ê‡∏¥‡∏ô')">‡∏ó‡∏µ‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏†‡∏≤‡∏û‡∏Å‡∏ê‡∏¥‡∏ô</button>
  <button class="option-team" onclick="vote('‡∏ó‡∏µ‡∏°‡∏Ñ‡∏ô‡∏î‡∏µ‡πÑ‡∏°‡πà‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô')">‡∏ó‡∏µ‡∏°‡∏Ñ‡∏ô‡∏î‡∏µ‡πÑ‡∏°‡πà‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô</button>
  <button class="admin-btn" onclick="backHome()">‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<div id="votePageSolo" class="container">
  <h2>‡πÇ‡∏´‡∏ß‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</h2>
  <div id="soloButtons"></div>
  <button class="admin-btn" onclick="backHome()">‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<div id="thankYou" class="container">
  <h2>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï! üòä</h2>
  <button class="admin-btn" onclick="backHome()">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<div id="resultsPage" class="container">
  <h2>‡∏ú‡∏•‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢</h2>
  <div id="resultBars"></div>
  <button class="admin-btn" onclick="backHome()">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<div id="adminPanel" class="container">
  <h2>Admin Panel</h2>
  <button class="admin-btn" onclick="adminOpenPoll()">‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏ß‡∏ï</button>
  <button class="admin-btn" onclick="adminClosePoll()">‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏ß‡∏ï</button>
  <button class="admin-btn" onclick="showAdminResults()">‡∏î‡∏π‡∏ú‡∏•‡πÇ‡∏´‡∏ß‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  <button class="admin-btn" onclick="adminResetPoll()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÇ‡∏û‡∏•</button>
  <button class="admin-btn" onclick="closeAdminPanel()">‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<div id="adminResults" class="container">
  <h2>‡∏ú‡∏•‡πÇ‡∏´‡∏ß‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
  <h3 style="color:#457B9D;">‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡∏°</h3>
  <div id="adminResultTeam"></div>
  <h3 style="color:#E76F51;margin-top:25px;">‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</h3>
  <div id="adminResultSolo"></div>
  <button class="admin-btn" onclick="backToAdmin()">‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxC8f6ruRqvPMrYPtJnFGdMiZJw1V9jh3U6O5kWKzAM7LYSo8vo_7F48_85-msw0AhI/exec"; // <-- ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Web App
let votesTeam = JSON.parse(localStorage.getItem('votesTeam')) || {'‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏ô‡∏≠‡∏±‡∏ß':0,'‡∏ó‡∏µ‡∏°‡∏™‡∏ß‡∏¢‡πÉ‡∏´‡πâ 5 ‡∏°‡∏±‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ 10':0,'‡∏ó‡∏µ‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏†‡∏≤‡∏û‡∏Å‡∏ê‡∏¥‡∏ô':0,'‡∏ó‡∏µ‡∏°‡∏Ñ‡∏ô‡∏î‡∏µ‡πÑ‡∏°‡πà‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô':0};
let votesSolo = JSON.parse(localStorage.getItem('votesSolo')) || {};
let pollOpen = true;
const ADMIN_PASSWORD = "1234";

function hideAll(){ ['homePage','votePageTeam','votePageSolo','thankYou','resultsPage','adminPanel','adminResults'].forEach(id=>document.getElementById(id).style.display='none'); }
function backHome(){ hideAll(); document.getElementById('homePage').style.display='block'; }
function showTeam(){ hideAll(); localStorage.setItem('currentMode','team'); document.getElementById('votePageTeam').style.display='block'; }
function showSolo(){ hideAll(); localStorage.setItem('currentMode','solo'); const soloDiv=document.getElementById('soloButtons'); soloDiv.innerHTML=""; for(let i=1;i<=10;i++){ const key="‡πÄ‡∏ö‡∏≠‡∏£‡πå "+i; if(!(key in votesSolo)) votesSolo[key]=0; const btn=document.createElement('button'); btn.className='option-solo'; btn.textContent=key; btn.onclick=()=>vote(key); soloDiv.appendChild(btn); } document.getElementById('votePageSolo').style.display='block'; }

async function sendVoteToSheet(option, mode, count){
  try{
    const response = await fetch(WEB_APP_URL, { method:'POST', body: JSON.stringify({option, mode, count}), headers:{'Content-Type':'application/json'} });
    const result = await response.json();
    console.log("‡∏™‡πà‡∏á‡πÇ‡∏´‡∏ß‡∏ï‡πÑ‡∏õ Google Sheets:", result);
  }catch(err){ console.error("‡∏™‡πà‡∏á‡πÇ‡∏´‡∏ß‡∏ï‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err); }
}

function vote(option){
  if(!pollOpen){ alert("‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
  const mode = localStorage.getItem('currentMode');
  if(mode==='team' && localStorage.getItem('votedTeam')){ alert("‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏´‡∏ß‡∏ï‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
  if(mode==='solo' && localStorage.getItem('votedSolo')){ alert("‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏´‡∏ß‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
  if(mode==='team'){ votesTeam[option]++; localStorage.setItem('votesTeam',JSON.stringify(votesTeam)); localStorage.setItem('votedTeam','true'); sendVoteToSheet(option, 'team', votesTeam[option]); }
  else if(mode==='solo'){ votesSolo[option]++; localStorage.setItem('votesSolo',JSON.stringify(votesSolo)); localStorage.setItem('votedSolo','true'); sendVoteToSheet(option, 'solo', votesSolo[option]); }
  hideAll(); document.getElementById('thankYou').style.display='block';
}

function showResults(type){ hideAll(); document.getElementById('resultsPage').style.display='block'; displayResults(type); }
function displayResults(type){
  const data = type==='team'?votesTeam:votesSolo;
  const total = Object.values(data).reduce((a,b)=>a+b,0);
  const container = document.getElementById('resultBars'); container.innerHTML="";
  for(let opt in data){
    const pct = total===0?0:Math.round((data[opt]/total)*100);
    const color = type==='team'? '#457B9D':'#E76F51';
    const div = document.createElement('div');
    div.innerHTML=`<div style="text-align:left;margin-top:10px;">${opt}</div><div class="bar-container"><div class="bar" style="background:${color};width:${pct}%">${data[opt]} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (${pct}%)</div></div>`;
    container.appendChild(div);
  }
}

function promptAdmin(){ const pass=prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ Admin:"); if(pass===ADMIN_PASSWORD){ hideAll(); document.getElementById('adminPanel').style.display='block'; } else if(pass!==null){ alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"); } }
function closeAdminPanel(){ backHome(); }
function adminOpenPoll(){ pollOpen=true; alert("‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏ß‡∏ï‡πÅ‡∏•‡πâ‡∏ß"); }
function adminClosePoll(){ pollOpen=false; alert("‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏ß‡∏ï‡πÅ‡∏•‡πâ‡∏ß"); }
function adminResetPoll(){ localStorage.clear(); votesTeam={'‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏ô‡∏≠‡∏±‡∏ß':0,'‡∏ó‡∏µ‡∏°‡∏™‡∏ß‡∏¢‡πÉ‡∏´‡πâ 5 ‡∏°‡∏±‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ 10':0,'‡∏ó‡∏µ‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏†‡∏≤‡∏û‡∏Å‡∏ê‡∏¥‡∏ô':0,'‡∏ó‡∏µ‡∏°‡∏Ñ‡∏ô‡∏î‡∏µ‡πÑ‡∏°‡πà‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô':0}; votesSolo={}; alert("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÇ‡∏û‡∏•‡πÅ‡∏•‡πâ‡∏ß"); }
function backToAdmin(){ hideAll(); document.getElementById('adminPanel').style.display='block'; }

function showAdminResults(){ hideAll(); document.getElementById('adminResults').style.display='block'; renderAdminResults('team','adminResultTeam'); renderAdminResults('solo','adminResultSolo'); }
function renderAdminResults(type,divId){
  const container=document.getElementById(divId); const data = type==='team'?votesTeam:votesSolo; const total = Object.values(data).reduce((a,b)=>a+b,0); container.innerHTML="";
  for(let opt in data){
    const pct = total===0?0:Math.round((data[opt]/total)*100);
    const color = type==='team'? '#A8DADC':'#F4A261';
    const div = document.createElement('div');
    div.innerHTML=`<div style="text-align:left;margin-top:10px;">${opt}</div><div class="bar-container"><div class="bar" style="background:${color};width:${pct}%">${data[opt]} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (${pct}%)</div></div>`;
    container.appendChild(div);
  }
}
</script>
</body>
</html>
